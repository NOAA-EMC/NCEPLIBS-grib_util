<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>copygb: /home/ed/NCEPLIBS-grib_util/src/copygb/copygb.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">copygb
   &#160;<span id="projectnumber">1.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('copygb_8F90_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">copygb.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="copygb_8F90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="copygb_8F90.html#a7040899b7ddeb78c67ea1761db6c0d40">  149</a></span>&#160;<span class="keyword">PROGRAM</span> <a class="code" href="copygb_8F90.html#a7040899b7ddeb78c67ea1761db6c0d40">copygb</a></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordtype">CHARACTER*256</span> carg,cg1,cx1,cgb,cxb,cgm,cxm,cg2,cnl</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordtype">INTEGER</span> karg(100), nthreads</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">INTEGER</span> kgdsi(200),ipopt(20),jpds1(200),jpdsb(200),iuv(100)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">  REAL</span> rarg(100)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">CHARACTER*400</span> gds</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">DATA</span> nthreads/1/</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">DATA</span> igi/-1/,kgdsi/19*0,255,180*0/</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">DATA</span> ip/0/,ipopt/20*-1/</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keyword">DATA</span> jpds1/200*-1/,jpdsb/200*-1/,iuv/33,99*0/,nuv/1/</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keyword">DATA</span> lwg/0/,lapp/0/,lxx/0/,lx/1/,kz1/-1/,kz2/-2/</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keyword">DATA</span> jb/0/,jbk/0/,lab/1/,ab/-1.e30/,lam/0/,am/0./</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">DATA</span> cgb/<span class="stringliteral">&#39; &#39;</span>/,cxb/<span class="stringliteral">&#39; &#39;</span>/,cgm/<span class="stringliteral">&#39; &#39;</span>/,cxm/<span class="stringliteral">&#39; &#39;</span>/,cnl/<span class="stringliteral">&#39; &#39;</span>/</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">INTEGER</span> ids(255),ibs(255),nbs(255)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keywordtype">  NAMELIST</span>/nlcopygb/ ids,ibs,nbs</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keyword">DATA</span> ids/255*-9999/,ibs/255*-9999/,nbs/255*-9999/</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">!  PARSE COMMAND LINE OPTIONS</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  narg=iargc()</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  iarg=1</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  lstopt=0</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(iarg.LE.narg.AND.lstopt.EQ.0)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;     larg=len_trim(carg)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     iarg=iarg+1</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     <span class="keywordflow">IF</span>(carg(1:1).NE.<span class="stringliteral">&#39;-&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        lstopt=1</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        iarg=iarg-1</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     <span class="keywordflow">ELSEIF</span>(larg.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: invalid option -&#39;</span>)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        l=2</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(l.LE.larg)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;           <span class="keywordflow">IF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;-&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              lstopt=1</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;a&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;              lapp=1</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;A&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                 l=0</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;              <span class="keywordflow">IF</span>(carg(l+1:l+1).EQ.<span class="stringliteral">&#39;&gt;&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                 lab=1</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                 l=l+1</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;              <span class="keywordflow">ELSEIF</span>(carg(l+1:l+1).EQ.<span class="stringliteral">&#39;&lt;&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                 lab=-1</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                 l=l+1</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                 <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: invalid threshold &#39;</span>// &amp;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                      carg(l+1:larg))</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                 <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                 <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;              <span class="keyword">CALL </span>fparser(carg(l+1:larg),1,ab)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;              l=larg</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;B&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                 l=0</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;              lcgb=larg-l</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;              cgb=carg(l+1:larg)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;              l=larg</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;b&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                 l=0</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;              lcxb=larg-l</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              cxb=carg(l+1:larg)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              l=larg</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;g&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                 l=0</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              karg(1)=igi</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;              karg(2:100)=kgdsi(1:99)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;              <span class="keyword">CALL </span>fparsei(carg(l+1:larg),100,karg)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;              igi=karg(1)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;              <span class="keywordflow">IF</span>(igi.GT.0.AND.igi.LT.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                 <span class="keyword">CALL </span>makgds(igi,kgdsi,gds,lgds,iret)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                 <span class="keywordflow">IF</span>(iret.NE.0) igi=-1</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;              <span class="keywordflow">ELSEIF</span>(igi.EQ.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                 kgdsi(1:99)=karg(2:100)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              <span class="keywordflow">IF</span>(igi.LT.-4.OR.igi.EQ.0.OR.igi.GT.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                 <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: invalid output grid &#39;</span>// &amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                      carg(l+1:larg))</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                 <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                 <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              mi=lengds(kgdsi)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;              <span class="keywordflow">IF</span>(mi.LE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                 <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: unsupported output grid &#39;</span>// &amp;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                      carg(l+1:larg))</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                 <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                 <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;              l=larg</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;i&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                 l=0</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;              karg(1)=ip</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              karg(2:21)=ipopt</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;              <span class="keyword">CALL </span>fparsei(carg(l+1:larg),21,karg)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;              ip=karg(1)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;              ipopt=karg(2:21)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;              l=larg</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;K&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                 l=0</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;              jbk=1</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              <span class="keyword">CALL </span>fparsei(carg(l+1:larg),100,jpdsb)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              <span class="keywordflow">IF</span>(jpdsb(5).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                 <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: invalid PDS parms &#39;</span>// &amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                      carg(l+1:larg))</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                 <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                 <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;              l=larg</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;k&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                 l=0</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              <span class="keywordflow">IF</span>(carg(l+1:larg).EQ.<span class="stringliteral">&#39;w&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                 lwg=1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                 <span class="keyword">CALL </span>fparsei(carg(l+1:larg),100,jpds1)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                 <span class="keywordflow">IF</span>(jpds1(5).EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                    <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: invalid PDS parms &#39;</span>// &amp;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                         carg(l+1:larg))</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordflow">                 ENDIF</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;              l=larg</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;M&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                 l=0</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;              <span class="keywordflow">IF</span>(carg(l+1:l+1).EQ.<span class="stringliteral">&#39;#&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                 l=l+1</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                 <span class="keyword">CALL </span>fparser(carg(l+1:larg),1,am)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                 lam=1</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                 lcgm=larg-l</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                 cgm=carg(l+1:larg)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                 lam=5</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;              l=larg</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;m&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                 l=0</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;              lcxm=larg-l</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;              cxm=carg(l+1:larg)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;              l=larg</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;N&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                 l=0</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;              lcnl=larg-l</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;              cnl=carg(l+1:larg)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              l=larg</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;v&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              <span class="keywordflow">IF</span>(l.EQ.larg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                 l=0</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                 <span class="keyword">CALL </span>getarg(iarg,carg)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                 larg=len_trim(carg)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                 iarg=iarg+1</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              <span class="keyword">CALL </span>fparsei(carg(l+1:larg),100,iuv)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              nuv=1</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;              <span class="keywordflow">DO</span> juv=2,100</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                 <span class="keywordflow">IF</span>(iuv(juv).NE.0) nuv=juv</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordflow">              ENDDO</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;              l=larg</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;x&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;              lx=0</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;           <span class="keywordflow">ELSEIF</span>(carg(l:l).EQ.<span class="stringliteral">&#39;X&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;              lxx=1</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;           <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;              <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: invalid option &#39;</span>//carg(l:l))</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;              <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;              <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;           l=l+1</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">  ENDDO</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">! DEFAULT OMP_NUM_THREADS COUNT TO SINGLE THREAD.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">!</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor"></span>  <span class="keyword">CALL </span>omp_set_num_threads (nthreads)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">!  PARSE COMMAND LINE POSITIONAL ARGUMENTS</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  nxarg=lx+2</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">IF</span>(narg-iarg+1.NE.nxarg) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb: incorrect number of arguments&#39;</span>)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     <span class="keyword">CALL </span>errexit(nxarg)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keyword">CALL </span>getarg(iarg,cg1)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  lcg1=len_trim(cg1)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  iarg=iarg+1</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  lg1=11</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keyword">CALL </span>baopenr(lg1,cg1(1:lcg1),iretba)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;     <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cg1(1:lcg1))</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;     <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">IF</span>(lx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     <span class="keyword">CALL </span>getarg(iarg,cx1)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;     lcx1=len_trim(cx1)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;     iarg=iarg+1</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;     lx1=31</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;     <span class="keyword">CALL </span>baopenr(lx1,cx1(1:lcx1),iretba)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cx1(1:lcx1))</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;     lx1=0</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keyword">CALL </span>getarg(iarg,cg2)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  lcg2=len_trim(cg2)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  iarg=iarg+1</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">IF</span>(cg2(1:lcg2).EQ.<span class="stringliteral">&#39;-&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  piping incompatible with the X option&#39;</span>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keyword">CALL </span>errexit(1)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;     lg2=6</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;     lg2=51</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;     <span class="keywordflow">IF</span>(lapp.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keyword">CALL </span>baopenwt(lg2,cg2(1:lcg2),iretba)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keyword">CALL </span>baopenwa(lg2,cg2(1:lcg2),iretba)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;     <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cg2(1:lcg2))</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">!  OPEN MAP FILE</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">IF</span>(cgb.NE.<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;     <span class="keywordflow">IF</span>(cgb(1:2).EQ.<span class="stringliteral">&#39;-1&#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">IF</span>(jpdsb(5).EQ.-1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;           jb=1</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;           jb=4</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;           lgb=lg1</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;           lxb=lx1</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        jb=4</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        lgb=14</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keyword">CALL </span>baopenr(lgb,cgb(1:lcgb),iretba)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;           <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cgb(1:lcgb))</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;           <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">IF</span>(cxb(1:1).NE.<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;           lxb=34</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;           <span class="keyword">CALL </span>baopenr(lxb,cxb(1:lcxb),iretba)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;           <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cxb(1:lcxb))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;           lxb=0</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">!  OPEN MERGE FILE</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">IF</span>(cgm.NE.<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     lam=5</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;     lgm=15</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;     <span class="keyword">CALL </span>baopenr(lgm,cgm(1:lcgm),iretba)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;     <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cgm(1:lcgm))</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;     <span class="keywordflow">IF</span>(cxm(1:1).NE.<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        lxm=35</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keyword">CALL </span>baopenr(lxm,cxm(1:lcxm),iretba)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">IF</span>(iretba.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;           <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cxm(1:lcxm))</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;           <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        lxm=0</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">!  OPEN AND READ NAMELIST FILE</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">IF</span>(cnl.NE.<span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;     lnl=2</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;     <span class="keyword">OPEN</span>(lnl,file=cnl(1:lcnl),status=<span class="stringliteral">&#39;OLD&#39;</span>,iostat=iret)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;     <span class="keywordflow">IF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error accessing file &#39;</span>//cnl(1:lcnl))</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;     <span class="keyword">READ</span>(lnl,nlcopygb,iostat=iret)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     <span class="keywordflow">IF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;copygb:  error reading namelist from file &#39;</span>// &amp;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;             cnl(1:lcnl))</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keyword">CALL </span>errexit(8)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">!  GO</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;     <span class="keyword">CALL </span>w3tagb(<span class="stringliteral">&#39;COPYGB  &#39;</span>,1998,0295,0047,<span class="stringliteral">&#39;NP23   &#39;</span>)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a51115fb32e7e74086bb23be1c8b46843">cpgb</a>(lg1,lx1,lgb,lxb,lgm,lxm,lg2, &amp;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;       igi,kgdsi,ip,ipopt,jpds1,nuv,iuv, &amp;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;       jpdsb,jb,jbk,lab,ab,lam,am,lxx,lwg, &amp;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       ids,ibs,nbs)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;     <span class="keyword">CALL </span>w3tage(<span class="stringliteral">&#39;COPYGB  &#39;</span>)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keyword">END PROGRAM </span><a class="code" href="copygb_8F90.html#a7040899b7ddeb78c67ea1761db6c0d40">copygb</a></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno"><a class="line" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">  514</a></span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;Usage: copygb&#39;</span>// &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;       <span class="stringliteral">&#39; [-g &quot;grid [kgds]&quot;] [-i &quot;ip [ipopts]&quot;]&#39;</span>// &amp;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;       <span class="stringliteral">&#39; [-k &quot;kpds&quot;] [-v &quot;uparms&quot;]&#39;</span>)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;             &#39;</span>// &amp;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       <span class="stringliteral">&#39; [-B mapgrib [-b mapindex] [-A &quot;&lt;&gt; mapthreshold&quot;]&#39;</span>// &amp;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       <span class="stringliteral">&#39; [-K &quot;mapkpds&quot;]]&#39;</span>)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;             &#39;</span>// &amp;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       <span class="stringliteral">&#39; [-M &quot;mask&quot;/mergegrib [-m mergeindex]] [-X] [-a]&#39;</span>// &amp;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;       <span class="stringliteral">&#39; [-N namelist]&#39;</span>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;       then either:&#39;</span>)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;             &#39;</span>// &amp;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;       <span class="stringliteral">&#39; grib1 index1 grib2&#39;</span>)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;            or:&#39;</span>)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keyword">CALL </span>errmsg(<span class="stringliteral">&#39;             &#39;</span>// &amp;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;       <span class="stringliteral">&#39; -x grib1 grib2&#39;</span>)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="copygb_8F90.html#a51115fb32e7e74086bb23be1c8b46843">  563</a></span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="copygb_8F90.html#a51115fb32e7e74086bb23be1c8b46843">cpgb</a>(LG1,LX1,LGB,LXB,LGM,LXM,LG2, &amp;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;     IGI,KGDSI,IP,IPOPT,JPDS1,NUV,IUV, &amp;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;     JPDSB,JB,JBK,LAB,AB,LAM,AM,LXX,LWG, &amp;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;     IDS,IBS,NBS)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  parameter(mbuf=256*1024)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordtype">CHARACTER</span> CBUF1(MBUF),CBUFB(MBUF),CBUFM(MBUF)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordtype">INTEGER</span> JPDS1(100),JPDSB(100),IUV(100)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">INTEGER</span> KGDSI(200)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordtype">INTEGER</span> IPOPT(20)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordtype">INTEGER</span> IDS(255),IBS(255),NBS(255)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordtype">INTEGER</span> JPDS(200),JGDS(200),JENS(5)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordtype">INTEGER</span> KPDS1(200),KGDS1(200),KENS1(5)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordtype">INTEGER</span> KPDSB(200),KGDSB(200),KENSB(5)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordtype">INTEGER</span> KPDSM(200),KGDSM(200),KENSM(5)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="keywordtype">CHARACTER*80</span> CIN</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">!  READ GRIB HEADERS</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keyword">CALL </span>instrument(6,kall0,ttot0,tmin0,tmax0)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">IF</span>(jb.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;     jgds=-1</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;     jens=-1</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     krb=-1</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;     kpdsb=0</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;     kgdsb=0</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     <span class="keyword">CALL </span>getgbemh(lgb,lxb,krb,jpdsb,jgds,jens, &amp;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          mbuf,cbufb,nlenb,nnumb,mnumb, &amp;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          kb,mb,krbx,kpdsb,kgdsb,kensb,iret)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0.AND.mb.LE.0) iret=255</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.99) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;           print *,<span class="stringliteral">&#39;copygb map field not found&#39;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">ELSEIF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;           print *,<span class="stringliteral">&#39;copygb map field retrieval error code &#39;</span>,iret</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;     mb=1</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;     iret=0</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;     kr1=-1</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;     <span class="keywordflow">IF</span>(lwg.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keyword">READ</span> (*,*,iostat=iret) cin</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;           ndel=scan(cin,<span class="stringliteral">&quot;:&quot;</span>)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;           <span class="keywordflow">IF</span>(ndel.GT.0) cin=cin(:ndel-1)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;           <span class="keyword">READ</span>(cin,*) kr1</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;           kr1=-kr1</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        jgds=-1</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        jens=-1</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        kpds1=0</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        kgds1=0</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">CALL </span>getgbemh(lg1,lx1,kr1,jpds1,jgds,jens, &amp;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;             mbuf,cbuf1,nlen1,nnum1,mnum1, &amp;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;             k1,m1,kr1x,kpds1,kgds1,kens1,iret)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0.AND.m1.LE.0) iret=255</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        kr1=kr1x</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;           <span class="keywordflow">IF</span>(iret.EQ.99) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;              print *,<span class="stringliteral">&#39;copygb field not found&#39;</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;           <span class="keywordflow">ELSEIF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;              print *,<span class="stringliteral">&#39;copygb header retrieval error code &#39;</span>,iret</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">!  LOOP UNTIL DONE</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  no=0</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(iret.EQ.0)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;     <span class="keywordflow">IF</span>(lam.EQ.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        jpds=-1</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        jpds(5:7)=kpds1(5:7)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        jgds=-1</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        jens=-1</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        krm=-1</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        kpdsm=0</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        kgdsm=0</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keyword">CALL </span>getgbemh(lgm,lxm,krm,jpds,jgds,jens, &amp;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;             mbuf,cbufm,nlenm,nnumm,mnumm, &amp;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;             km,mm,krmx,kpdsm,kgdsm,kensm,iret)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0.AND.mm.LE.0) iret=255</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">IF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;           mm=0</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;           kpdsm=0</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;           kgdsm=0</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;           iret=0</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;     <span class="keywordflow">IF</span>(igi.EQ.-1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        igi=kpds1(3)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        kgdsi=kgds1</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        mi=m1</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;     <span class="keywordflow">ELSEIF</span>(igi.EQ.-4.AND.jb.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        igi=kpdsb(3)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        kgdsi=kgdsb</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        mi=mb</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;     <span class="keywordflow">ELSEIF</span>(igi.EQ.-5.AND.lam.EQ.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        igi=kpdsm(3)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        kgdsi=kgdsm</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        mi=mm</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        mi=lengds(kgdsi)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keyword">CALL </span>instrument(1,kall1,ttot1,tmin1,tmax1)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;     <span class="keywordflow">IF</span>(igi.GT.0.AND.igi.LE.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        mf=max(m1,mb,mm)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a369c60f0dad4410101fac26abc6559b4">cpgb1</a>(lg1,lx1,m1,cbuf1,nlen1,nnum1,mnum1, &amp;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;             mbuf,mf,mi, &amp;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;             igi,kgdsi,ip,ipopt,jpds1,nuv,iuv, &amp;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;             jpdsb,jb,jbk,lab,ab,lam,am, &amp;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;             ids,ibs,nbs, &amp;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;             lgb,lxb,mb,cbufb,nlenb,nnumb,mnumb, &amp;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;             lgm,lxm,mm,cbufm,nlenm,nnumm,mnumm, &amp;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;             lg2,lxx,kr1-1,no,iret1)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;     <span class="keywordflow">IF</span>(lwg.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keyword">READ</span> (*,*,iostat=iret) cin</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;           ndel=scan(cin,<span class="stringliteral">&quot;:&quot;</span>)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;           <span class="keywordflow">IF</span>(ndel.GT.0) cin=cin(:ndel-1)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;           <span class="keyword">READ</span>(cin,*) kr1</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;           kr1=kr1-1</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        jgds=-1</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        jens=-1</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        kpds1=0</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        kgds1=0</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keyword">CALL </span>getgbemh(lg1,lx1,kr1,jpds1,jgds,jens, &amp;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;             mbuf,cbuf1,nlen1,nnum1,mnum1, &amp;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;             k1,m1,kr1x,kpds1,kgds1,kens1,iret)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0.AND.m1.LE.0) iret=255</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        kr1=kr1x</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;           <span class="keywordflow">IF</span>(iret.NE.0.AND.iret.NE.99) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;              print *,<span class="stringliteral">&#39;copygb header retrieval error code &#39;</span>,iret</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordflow">  ENDDO</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;     print *,<span class="stringliteral">&#39;copygb wrote &#39;</span>,no,<span class="stringliteral">&#39; total records&#39;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;     <span class="keyword">CALL </span>instrument(1,kall1,ttot1,tmin1,tmax1)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     print *,<span class="stringliteral">&#39;Instrumentation Report&#39;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; seconds spent searching headers&quot;)&#39;</span>,ttot1</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;     <span class="keyword">CALL </span>instrument(-2,kall2,ttot2,tmin2,tmax2)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; seconds spent reading and unpacking&quot;)&#39;</span>,ttot2</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;     <span class="keyword">CALL </span>instrument(-3,kall3,ttot3,tmin3,tmax3)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; seconds spent manipulating masks&quot;)&#39;</span>,ttot3</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;     <span class="keyword">CALL </span>instrument(-4,kall4,ttot4,tmin4,tmax4)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; seconds spent interpolating or copying&quot;)&#39;</span>,ttot4</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;     <span class="keyword">CALL </span>instrument(-5,kall5,ttot5,tmin5,tmax5)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; seconds spent merging&quot;)&#39;</span>,ttot5</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;     <span class="keyword">CALL </span>instrument(-6,kall6,ttot6,tmin6,tmax6)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; seconds spent packing and writing&quot;)&#39;</span>,ttot6</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;     ttott=ttot1+ttot2+ttot3+ttot4+ttot5+ttot6</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;     print <span class="stringliteral">&#39;(F10.3,&quot; total seconds spent in copygb&quot;)&#39;</span>,ttott</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="copygb_8F90.html#a51115fb32e7e74086bb23be1c8b46843">cpgb</a></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno"><a class="line" href="copygb_8F90.html#a369c60f0dad4410101fac26abc6559b4">  780</a></span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="copygb_8F90.html#a369c60f0dad4410101fac26abc6559b4">cpgb1</a>(LG1,LX1,M1,CBUF1,NLEN1,NNUM1,MNUM1, &amp;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;     MBUF,MF,MI, &amp;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;     IGI,KGDSI,IP,IPOPT,JPDS1,NUV,IUV, &amp;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;     JPDSB,JB,JBK,LAB,AB,LAM,AM, &amp;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;     IDS,IBS,NBS, &amp;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;     LGB,LXB,MB,CBUFB,NLENB,NNUMB,MNUMB, &amp;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;     LGM,LXM,MM,CBUFM,NLENM,NNUMM,MNUMM, &amp;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;     LG2,LXX,KS1,NO,IRET)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordtype">CHARACTER</span> CBUF1(MBUF),CBUFB(MBUF),CBUFM(MBUF)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordtype">INTEGER</span> JPDS1(100),JPDSB(100),IUV(100)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordtype">INTEGER</span> KGDSI(200)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordtype">INTEGER</span> IPOPT(20)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordtype">INTEGER</span> IDS(255),IBS(255),NBS(255)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordtype">INTEGER</span> JPDS(200),JGDS(200),JENS(5)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordtype">INTEGER</span> KPDS1(200),KGDS1(200),KENS1(5)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordtype">INTEGER</span> KPDSB(200),KGDSB(200),KENSB(5)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="keywordtype">INTEGER</span> KPDSM(200),KGDSM(200),KENSM(5)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">LOGICAL*1</span> LR(MF),L1I(MI),LBI(MI)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordtype">  REAL</span> FR(MF),F1I(MI),FBI(MI)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="keywordtype">  REAL</span> GR(MF),G1I(MI),GBI(MI)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">!  GET FIELD FROM FILE 1</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  jgds=-1</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  kpds1=0</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  kgds1=0</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keyword">CALL </span>getgbem(lg1,lx1,m1,ks1,jpds1,jgds,jens, &amp;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;       mbuf,cbuf1,nlen1,nnum1,mnum1, &amp;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;       k1,kr1,kpds1,kgds1,kens1,lr,fr,iret)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;     ib1=mod(kpds1(4)/64,2)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;     ids2=kpds1(22)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;     iv=0</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     krv=0</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;     juv=1</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;     <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(juv.LE.nuv.AND.kpds1(5).NE.iuv(juv).AND. &amp;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          kpds1(5).NE.iuv(juv)+1)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        juv=juv+1</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="keywordflow">     ENDDO</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;     <span class="keywordflow">IF</span>(juv.LE.nuv.AND.kpds1(5).EQ.iuv(juv)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        iv=1</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        jpds=-1</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        jpds(1:24)=kpds1(1:24)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        jpds(22)=-1</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        jpds(5)=kpds1(5)+1</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        jgds=kgds1</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        jens=kens1</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keyword">CALL </span>getgbem(lg1,lx1,m1,krv,jpds,jgds,jens, &amp;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;             mbuf,cbuf1,nlen1,nnum1,mnum1, &amp;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;             k1,krvx,kpds1,kgds1,kens1,lr,gr,iret)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        krv=krvx</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        kpds1(5)=jpds(5)-1</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        kpds1(22)=max(ids2,kpds1(22))</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;     <span class="keywordflow">ELSEIF</span>(juv.LE.nuv.AND.kpds1(5).EQ.iuv(juv)+1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        iret=-1</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.-1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        print *,<span class="stringliteral">&#39;copygb skipping 2nd vector component field&#39;</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;     <span class="keywordflow">ELSEIF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        print *,<span class="stringliteral">&#39;copygb data retrieval error code &#39;</span>,iret</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;     <span class="keywordflow">ELSEIF</span>(krv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        print *,<span class="stringliteral">&#39;copygb read scalar field from record &#39;</span>,kr1</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpds1(i),i=1,24)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        print *,<span class="stringliteral">&#39;copygb read vector field from records &#39;</span>,kr1,krv</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpds1(i),i=1,24)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpds1(i),i=1,4), &amp;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;             kpds1(5)+1,(kpds1(i),i=6,24)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;     <span class="keyword">CALL </span>instrument(2,kall2,ttot2,tmin2,tmax2)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">!  INVOKE MAP MASK BEFORE INTERPOLATION</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0.AND.jbk.EQ.1.AND.jb.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;     <span class="keywordflow">DO</span> i=1,k1</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">IF</span>(lr(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;           <span class="keywordflow">IF</span>((lab.EQ.1.AND.fr(i).LE.ab).OR. &amp;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                (lab.EQ.-1.AND.fr(i).GE.ab)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              ib1=1</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              lr(i)=.false.</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="keywordflow">     ENDDO</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        print *,<span class="stringliteral">&#39;       applied pre-interpolation map mask&#39;</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keyword">CALL </span>instrument(3,kall3,ttot3,tmin3,tmax3)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">!  INTERPOLATE FIELD</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;     <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef">intgrib</a>(iv,ip,ipopt,kgds1,k1,ib1,lr,fr,gr,kgdsi,mi, &amp;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          ib1i,l1i,f1i,g1i,iret)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;           print *,<span class="stringliteral">&#39;       interpolated to grid &#39;</span>,igi</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">ELSEIF</span>(iret.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;           print *,<span class="stringliteral">&#39;       interpolation error code &#39;</span>,iret</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keyword">CALL </span>instrument(4,kall4,ttot4,tmin4,tmax4)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.-1) iret=0</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">!  GET MAP FIELD</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0.AND.jb.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;     krb=0</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;     jgds=-1</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;     jens=-1</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;     <span class="keyword">CALL </span>getgbem(lgb,lxb,mb,krb,jpdsb,jgds,jens, &amp;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;          mbuf,cbufb,nlenb,nnumb,mnumb, &amp;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;          kb,krbx,kpdsb,kgdsb,kensb,lr,fr,iret)</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;           print *,<span class="stringliteral">&#39;       map field retrieved&#39;</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;           print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpdsb(i),i=1,24)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">ELSEIF</span>(iret.EQ.99) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;           print *,<span class="stringliteral">&#39;       map field not found&#39;</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;           print *,<span class="stringliteral">&#39;       map field retrieval error code &#39;</span>,iret</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;     <span class="comment">!  INTERPOLATE MAP FIELD</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        ibb=mod(kpdsb(4)/64,2)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef">intgrib</a>(0,ip,ipopt,kgdsb,kb,ibb,lr,fr,gr,kgdsi,mi, &amp;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;             ibbi,lbi,fbi,gbi,iret)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;           <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;              print *,<span class="stringliteral">&#39;       interpolated to grid &#39;</span>,igi</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;           <span class="keywordflow">ELSEIF</span>(iret.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;              print *,<span class="stringliteral">&#39;       interpolation error code &#39;</span>,iret</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.-1) iret=0</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">!  INVOKE MAP MASK</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;     <span class="keywordflow">IF</span>(jbk.EQ.0.AND.jb.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">DO</span> i=1,mi</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;           <span class="keywordflow">IF</span>(l1i(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;              <span class="keywordflow">IF</span>((lab.EQ.1.AND.f1i(i).LE.ab).OR. &amp;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                   (lab.EQ.-1.AND.f1i(i).GE.ab)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                 ib1i=1</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                 l1i(i)=.false.</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;           print *,<span class="stringliteral">&#39;       applied post-interpolation map mask&#39;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;     <span class="keywordflow">ELSEIF</span>(jb.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">DO</span> i=1,mi</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;           <span class="keywordflow">IF</span>(lbi(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;              <span class="keywordflow">IF</span>((lab.EQ.1.AND.fbi(i).LE.ab).OR. &amp;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                   (lab.EQ.-1.AND.fbi(i).GE.ab)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                 ib1i=1</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                 l1i(i)=.false.</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;           <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;              ib1i=1</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              l1i(i)=.false.</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;           print *,<span class="stringliteral">&#39;       applied fixed map mask&#39;</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;     <span class="comment">!  MASK VALUES</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     <span class="keywordflow">IF</span>(lam.EQ.1.AND.ib1i.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        ib1i=0</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">DO</span> i=1,mi</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;           <span class="keywordflow">IF</span>(.NOT.l1i(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;              l1i(i)=.true.</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;              f1i(i)=am</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;              <span class="keywordflow">IF</span>(krv.GT.0) g1i(i)=am</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;           print *,<span class="stringliteral">&#39;       substituted mask fill value&#39;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keyword">CALL </span>instrument(3,kall3,ttot3,tmin3,tmax3)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;     <span class="comment">!  MERGE FIELD</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     <span class="keywordflow">IF</span>(lam.EQ.5.AND.ib1i.EQ.1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        krm=0</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        jpds=-1</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        jpds(5:7)=kpds1(5:7)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        jgds=-1</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        jens=-1</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keyword">CALL </span>getgbem(lgm,lxm,mm,krm,jpds,jgds,jens, &amp;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;             mbuf,cbufm,nlenm,nnumm,mnumm, &amp;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;             km,krmx,kpdsm,kgdsm,kensm,lr,fr,iret)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0.AND.krv.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;           jpds=-1</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;           jpds(1:24)=kpdsm(1:24)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;           jpds(5)=kpdsm(5)+1</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;           jgds=kgdsm</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;           jens=kensm</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;           <span class="keyword">CALL </span>getgbem(lgm,lxm,mm,krm,jpds,jgds,jens, &amp;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                mbuf,cbufm,nlenm,nnumm,mnumm, &amp;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                km,krmx,kpdsm,kgdsm,kensm,lr,gr,iret)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;           kpdsm(5)=jpds(5)-1</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;           <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;              print *,<span class="stringliteral">&#39;       merge field retrieved&#39;</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;              print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpdsm(i),i=1,24)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;              <span class="keywordflow">IF</span>(krv.GT.0) &amp;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                   print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpdsm(i),i=1,4), &amp;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                   kpdsm(5)+1,(kpdsm(i),i=6,24)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;           <span class="keywordflow">ELSEIF</span>(iret.EQ.99) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;              print *,<span class="stringliteral">&#39;       merge field not found&#39;</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;           <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;              print *,<span class="stringliteral">&#39;       merge field retrieval error code &#39;</span>,iret</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;           ibm=mod(kpdsm(4)/64,2)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;           <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef">intgrib</a>(iv,ip,ipopt,kgdsm,km,ibm,lr,fr,gr,kgdsi,mi, &amp;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                ibbi,lbi,fbi,gbi,iret)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;           <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;              <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                 print *,<span class="stringliteral">&#39;       interpolated to grid &#39;</span>,igi</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;              <span class="keywordflow">ELSEIF</span>(iret.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                 print *,<span class="stringliteral">&#39;       interpolation error code &#39;</span>,iret</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;           <span class="keywordflow">IF</span>(iret.EQ.-1) iret=0</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;           <span class="keywordflow">DO</span> i=1,mi</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;              <span class="keywordflow">IF</span>(.NOT.l1i(i).AND.lbi(i)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                 l1i(i)=.true.</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                 f1i(i)=fbi(i)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                 <span class="keywordflow">IF</span>(krv.GT.0) g1i(i)=gbi(i)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordflow">           ENDDO</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;           <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;              print *,<span class="stringliteral">&#39;       merged output field with merge field&#39;</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        iret=0</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keyword">CALL </span>instrument(5,kall5,ttot5,tmin5,tmax5)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">!  WRITE OUTPUT FIELD</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;     kpds1(3)=igi</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;     kpds1(4)=128+64*ib1i</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;     k5=kpds1(5)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;     ids1=kpds1(22)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;     ibs1=0</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;     nbs1=0</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;     <span class="keywordflow">IF</span>(k5.GT.0.AND.k5.LT.256) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordflow">IF</span>(ids(k5).GE.-128.AND.ids(k5).LT.128) ids1=ids(k5)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">IF</span>(ibs(k5).GE.-128.AND.ibs(k5).LT.128) ibs1=ibs(k5)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="keywordflow">IF</span>(nbs(k5).GE.0.AND.nbs(k5).LT.256) nbs1=nbs(k5)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;     kpds1(22)=ids1</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;     <span class="keyword">CALL </span>putgben(lg2,mi,kpds1,kgdsi,kens1,ibs1,nbs1,l1i,f1i,iret)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) no=no+1</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0.AND.krv.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        kpds1(5)=k5+1</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keyword">CALL </span>putgben(lg2,mi,kpds1,kgdsi,kens1,ibs1,nbs1,l1i,g1i,iret)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) no=no+1</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        kpds1(5)=k5</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;     <span class="keywordflow">IF</span>(lxx.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">IF</span>(iret.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;           print *,<span class="stringliteral">&#39;       packing error code &#39;</span>,iret</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">ELSEIF</span>(krv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;           print *,<span class="stringliteral">&#39;       wrote scalar field to record &#39;</span>,no</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;           print *,<span class="stringliteral">&#39;       ...KPDS(1:24),IDS,IBS,NBS=&#39;</span>, &amp;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                (kpds1(i),i=1,24),ids1,ibs1,nbs1</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;           print *,<span class="stringliteral">&#39;       wrote vector field to records &#39;</span>,no-1,no</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;           print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpds1(i),i=1,24)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;           print *,<span class="stringliteral">&#39;       ...KPDS(1:24)=&#39;</span>,(kpds1(i),i=1,4), &amp;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                kpds1(5)+1,(kpds1(i),i=6,24)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keyword">CALL </span>instrument(6,kall6,ttot6,tmin6,tmax6)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="copygb_8F90.html#a369c60f0dad4410101fac26abc6559b4">cpgb1</a></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"><a class="line" href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef"> 1094</a></span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef">intgrib</a>(IV,IP,IPOPT,KGDS1,K1,IB1,L1,F1,G1,KGDS2,K2, &amp;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;     IB2,L2,F2,G2,IRET)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordtype">INTEGER</span> IPOPT(20)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordtype">INTEGER</span> KGDS1(200),KGDS2(200)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordtype">LOGICAL*1</span> L1(K1),L2(K2)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keywordtype">  REAL</span> F1(K1),F2(K2)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="keywordtype">  REAL</span> G1(K1),G2(K2)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordtype">INTEGER</span> KGDS1F(200),KGDS2F(200)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">!  DETERMINE WHETHER INTERPOLATION IS NECESSARY</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">IF</span>(ip.EQ.4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;     int=1</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;     int=0</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;     <span class="keywordflow">DO</span> i=1,200</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        int=max(int,abs(kgds1(i)-kgds2(i)))</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keywordflow">     ENDDO</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;     int=min(int,1)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="comment">!  COPY FIELD</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">IF</span>(int.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;     ib2=ib1</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;     <span class="keywordflow">DO</span> i=1,k1</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        l2(i)=l1(i)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        f2(i)=f1(i)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">IF</span>(iv.NE.0) g2(i)=g1(i)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keywordflow">     ENDDO</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;     iret=-1</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;     <span class="comment">!  COMPUTE REGULARIZED GRIDS AND INTERPOLATE FIELD</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;     k1f=<a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>(kgds1,kgds1f)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;     <span class="keywordflow">IF</span>(k1f.EQ.k1) k1f=1</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;     k2f=<a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>(kgds2,kgds2f)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;     <span class="keywordflow">IF</span>(k2f.EQ.k2) k2f=1</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;     mrl=max(k2,k2f)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;     <span class="keywordflow">IF</span>(iv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        mro=1</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        mro=mrl</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;     <span class="keywordflow">IF</span>(k1f.GT.0.AND.k2f.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keyword">CALL </span><a class="code" href="copygb_8F90.html#a9e3d7c96d2775978bd759715558d0e09">intgrib1</a>(k1f,kgds1f,k2f,kgds2f,mrl,mro, &amp;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;             iv,ip,ipopt,kgds1,k1,ib1,l1,f1,g1,kgds2,k2, &amp;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;             ib2,l2,f2,g2,iret)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        iret=101</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef">intgrib</a></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"><a class="line" href="copygb_8F90.html#a9e3d7c96d2775978bd759715558d0e09"> 1173</a></span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="copygb_8F90.html#a9e3d7c96d2775978bd759715558d0e09">intgrib1</a>(K1F,KGDS1F,K2F,KGDS2F,MRL,MRO, &amp;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;     IV,IP,IPOPT,KGDS1,K1,IB1,L1,F1,G1,KGDS2,K2, &amp;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;     IB2,L2,F2,G2,IRET)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="preprocessor">#ifdef USEIPMOD</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">USE </span>ip_mod</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">INTEGER</span> IPOPT(20)</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordtype">INTEGER</span> KGDS1(200),KGDS2(200)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordtype">LOGICAL*1</span> L1(K1),L2(K2)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keywordtype">  REAL</span> F1(K1),F2(K2),G1(K1),G2(K2)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordtype">INTEGER</span> KGDS1F(200),KGDS2F(200)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="keywordtype">LOGICAL*1</span> L1F(K1F),L2F(K2F)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="keywordtype">  REAL</span> F1F(K1F),F2F(K2F),G1F(K1F),G2F(K2F)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="keywordtype">  REAL</span> RLAT(MRL),RLON(MRL),CROT(MRO),SROT(MRO)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="comment">!  REGLR TO REGLR SCALAR</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <span class="keywordflow">IF</span>(k1f.EQ.1.AND.k2f.EQ.1.AND.iv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;     <span class="keyword">CALL </span>ipolates(ip,ipopt,kgds1,kgds2,k1,k2,1,ib1,l1,f1, &amp;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          ki,rlat,rlon,ib2,l2,f2,iret)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;     <span class="comment">!  IRREG TO REGLR SCALAR</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.NE.1.AND.k2f.EQ.1.AND.iv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;     <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keyword">CALL </span>ipxwafs3(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keyword">CALL </span>ipxwafs2(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keyword">CALL </span>ipolates(ip,ipopt,kgds1f,kgds2,k1f,k2,1,ib1f,l1f,f1f, &amp;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;             ki,rlat,rlon,ib2,l2,f2,iret)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;     <span class="comment">!  REGLR TO IRREG SCALAR</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.EQ.1.AND.k2f.NE.1.AND.iv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;     <span class="keyword">CALL </span>ipolates(ip,ipopt,kgds1,kgds2f,k1,k2f,1,ib1,l1,f1, &amp;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          ki,rlat,rlon,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;           <span class="keyword">CALL </span>ipxwafs3(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;           <span class="keyword">CALL </span>ipxwafs2(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;     <span class="comment">!  IRREG TO IRREG SCALAR</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.NE.1.AND.k2f.NE.1.AND.iv.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;     <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="keyword">CALL </span>ipxwafs3(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keyword">CALL </span>ipxwafs2(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keyword">CALL </span>ipolates(ip,ipopt,kgds1f,kgds2f,k1f,k2f,1,ib1f,l1f,f1f, &amp;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;             ki,rlat,rlon,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;           <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;              <span class="keyword">CALL </span>ipxwafs3(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                   kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;           <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;              <span class="keyword">CALL </span>ipxwafs2(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                   kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;     <span class="comment">!  REGLR TO REGLR VECTOR</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.EQ.1.AND.k2f.EQ.1.AND.iv.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;     <span class="keyword">CALL </span>ipolatev(ip,ipopt,kgds1,kgds2,k1,k2,1,ib1,l1,f1,g1, &amp;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          ki,rlat,rlon,crot,srot,ib2,l2,f2,g2,iret)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0.AND.ki.EQ.k2-1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        f2(k2)=0</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        g2(k2)=0</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;     <span class="comment">!  IRREG TO REGLR VECTOR</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.NE.1.AND.k2f.EQ.1.AND.iv.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;     <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keyword">CALL </span>ipxwafs3(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keyword">CALL </span>ipxwafs3(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;             kgds1,ib1,l1,g1,kgds1f,ib1f,l1f,g1f,iret)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keyword">CALL </span>ipxwafs2(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keyword">CALL </span>ipxwafs2(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;             kgds1,ib1,l1,g1,kgds1f,ib1f,l1f,g1f,iret)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keyword">CALL </span>ipolatev(ip,ipopt,kgds1f,kgds2,k1f,k2,1, &amp;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;             ib1f,l1f,f1f,g1f, &amp;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;             ki,rlat,rlon,crot,srot,ib2,l2,f2,g2,iret)</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0.AND.ki.EQ.k2-1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;           f2(k2)=0</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;           g2(k2)=0</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;     <span class="comment">!  REGLR TO IRREG VECTOR</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.EQ.1.AND.k2f.NE.1.AND.iv.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;     <span class="keyword">CALL </span>ipolatev(ip,ipopt,kgds1,kgds2f,k1,k2f,1,ib1,l1,f1,g1, &amp;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          ki,rlat,rlon,crot,srot,ib2f,l2f,f2f,g2f,iret)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;           <span class="keyword">CALL </span>ipxwafs3(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;           <span class="keyword">CALL </span>ipxwafs3(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                kgds2,ib2,l2,g2,kgds2f,ib2f,l2f,g2f,iret)</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;           <span class="keyword">CALL </span>ipxwafs2(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;           <span class="keyword">CALL </span>ipxwafs2(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                kgds2,ib2,l2,g2,kgds2f,ib2f,l2f,g2f,iret)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;     <span class="comment">!  IRREG TO IRREG VECTOR</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordflow">ELSEIF</span>(k1f.NE.1.AND.k2f.NE.1.AND.iv.NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;     <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="keyword">CALL </span>ipxwafs3(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keyword">CALL </span>ipxwafs3(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;             kgds1,ib1,l1,g1,kgds1f,ib1f,l1f,g1f,iret)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keyword">CALL </span>ipxwafs2(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;             kgds1,ib1,l1,f1,kgds1f,ib1f,l1f,f1f,iret)</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keyword">CALL </span>ipxwafs2(1,k1,k1f,1, &amp;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;             kgds1,ib1,l1,g1,kgds1f,ib1f,l1f,g1f,iret)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keyword">CALL </span>ipolatev(ip,ipopt,kgds1f,kgds2f,k1f,k2f,1, &amp;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;             ib1f,l1f,f1f,g1f, &amp;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;             ki,rlat,rlon,crot,srot,ib2f,l2f,f2f,g2f,iret)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;           <span class="keywordflow">IF</span>(ip.EQ.2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;              <span class="keyword">CALL </span>ipxwafs3(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                   kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;              <span class="keyword">CALL </span>ipxwafs3(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                   kgds2,ib2,l2,g2,kgds2f,ib2f,l2f,g2f,iret)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;           <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;              <span class="keyword">CALL </span>ipxwafs2(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                   kgds2,ib2,l2,f2,kgds2f,ib2f,l2f,f2f,iret)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;              <span class="keyword">CALL </span>ipxwafs2(-1,k2,k2f,1, &amp;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                   kgds2,ib2,l2,g2,kgds2f,ib2f,l2f,g2f,iret)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="keywordflow">           ENDIF</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="copygb_8F90.html#a9e3d7c96d2775978bd759715558d0e09">intgrib1</a></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"><a class="line" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d"> 1344</a></span>&#160;<span class="keyword">FUNCTION </span><a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>(KGDS,KGDSF)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="keywordtype">INTEGER</span> kgds(200),kgdsf(200)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  <span class="keywordflow">IF</span>(kgds(1).EQ.201) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;     kgdsf=kgds</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;     <a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>=kgds(7)*kgds(8)-kgds(8)/2</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">ELSEIF</span>(kgds(1).EQ.202) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;     kgdsf=kgds</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;     <a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>=kgds(7)*kgds(8)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">ELSEIF</span>(kgds(19).EQ.0.AND.kgds(20).NE.255) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;     <span class="keyword">CALL </span>ipxwafs(1,1,1,0,kgds,dum,kgdsf,dumf,iret)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;     <span class="keywordflow">IF</span>(iret.EQ.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>=kgdsf(2)*kgdsf(3)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>=0</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;     kgdsf=kgds</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;     <a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a>=kgds(2)*kgds(3)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="keywordflow">  ENDIF</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="keyword">END FUNCTION </span><a class="code" href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a></div>
<div class="ttc" id="acopygb_8F90_html_a2819226e8059d253d793e872d6edcb6c"><div class="ttname"><a href="copygb_8F90.html#a2819226e8059d253d793e872d6edcb6c">eusage</a></div><div class="ttdeci">subroutine eusage</div><div class="ttdoc">Print proper usage to stderr.</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l00514">copygb.F90:515</a></div></div>
<div class="ttc" id="acopygb_8F90_html_a369c60f0dad4410101fac26abc6559b4"><div class="ttname"><a href="copygb_8F90.html#a369c60f0dad4410101fac26abc6559b4">cpgb1</a></div><div class="ttdeci">subroutine cpgb1(LG1, LX1, M1, CBUF1, NLEN1, NNUM1, MNUM1, MBUF, MF, MI, IGI, KGDSI, IP, IPOPT, JPDS1, NUV, IUV, JPDSB, JB, JBK, LAB, AB, LAM, AM, IDS, IBS, NBS, LGB, LXB, MB, CBUFB, NLENB, NNUMB, MNUMB, LGM, LXM, MM, CBUFM, NLENM, NNUMM, MNUMM, LG2, LXX, KS1, NO, IRET)</div><div class="ttdoc">Copy one grib field.</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l00780">copygb.F90:788</a></div></div>
<div class="ttc" id="acopygb_8F90_html_a51115fb32e7e74086bb23be1c8b46843"><div class="ttname"><a href="copygb_8F90.html#a51115fb32e7e74086bb23be1c8b46843">cpgb</a></div><div class="ttdeci">subroutine cpgb(LG1, LX1, LGB, LXB, LGM, LXM, LG2, IGI, KGDSI, IP, IPOPT, JPDS1, NUV, IUV, JPDSB, JB, JBK, LAB, AB, LAM, AM, LXX, LWG, IDS, IBS, NBS)</div><div class="ttdoc">Copy grib files.</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l00563">copygb.F90:567</a></div></div>
<div class="ttc" id="acopygb_8F90_html_a7040899b7ddeb78c67ea1761db6c0d40"><div class="ttname"><a href="copygb_8F90.html#a7040899b7ddeb78c67ea1761db6c0d40">copygb</a></div><div class="ttdeci">program copygb</div><div class="ttdoc">The command copygb copies all or part of one GRIB file to another GRIB file, interpolating if necessa...</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l00149">copygb.F90:149</a></div></div>
<div class="ttc" id="acopygb_8F90_html_a9e3d7c96d2775978bd759715558d0e09"><div class="ttname"><a href="copygb_8F90.html#a9e3d7c96d2775978bd759715558d0e09">intgrib1</a></div><div class="ttdeci">subroutine intgrib1(K1F, KGDS1F, K2F, KGDS2F, MRL, MRO, IV, IP, IPOPT, KGDS1, K1, IB1, L1, F1, G1, KGDS2, K2, IB2, L2, F2, G2, IRET)</div><div class="ttdoc">Interpolate field.</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l01173">copygb.F90:1176</a></div></div>
<div class="ttc" id="acopygb_8F90_html_a9fd1e69f9b2f41e786568c99d88dc9ef"><div class="ttname"><a href="copygb_8F90.html#a9fd1e69f9b2f41e786568c99d88dc9ef">intgrib</a></div><div class="ttdeci">subroutine intgrib(IV, IP, IPOPT, KGDS1, K1, IB1, L1, F1, G1, KGDS2, K2, IB2, L2, F2, G2, IRET)</div><div class="ttdoc">Interpolate field.</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l01094">copygb.F90:1096</a></div></div>
<div class="ttc" id="acopygb_8F90_html_af8112839cf8632177295aedcbb78ed5d"><div class="ttname"><a href="copygb_8F90.html#af8112839cf8632177295aedcbb78ed5d">lengdsf</a></div><div class="ttdeci">function lengdsf(KGDS, KGDSF)</div><div class="ttdoc">Return the length of a filled grid.</div><div class="ttdef"><b>Definition:</b> <a href="copygb_8F90_source.html#l01344">copygb.F90:1345</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_64e8c993bcc377543e65e1f0ac6d01ca.html">copygb</a></li><li class="navelem"><a class="el" href="copygb_8F90.html">copygb.F90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
